<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>dCacheTools::PhedexComparison - Compare PhEDEx subscription list with the files locally
available on pnfs.</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#requires">REQUIRES</a></li>
	<li><a href="#inheritance">INHERITANCE</a></li>
	<li><a href="#exports">EXPORTS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#public_methods">Public methods</a></li>
	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#authors">AUTHORS</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#version">VERSION</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>dCacheTools::PhedexComparison - Compare PhEDEx subscription list with the files locally
available on pnfs.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
  use dCacheTools::PhedexComparison;
  my $obj = dCacheTools::PhedexComparison-&gt;new({
                node =&gt; q|T2_IT_Pisa|,
            pnfsroot =&gt; q|/pnfs/pi.infn.it/data/cms|, # cannot go further inside
           pnfs_dump =&gt; q|pnfs_files.txt|,
       pnfsonly_dump =&gt; q|pnfsonly_files.txt|,
         phedex_dump =&gt; q|phedex_files.txt|,
     phedexonly_dump =&gt; q|phedexonly_files.txt|,
             verbose =&gt; 0
  });
  $obj-&gt;compare;</pre>
<p>
</p>
<hr />
<h1><a name="requires">REQUIRES</a></h1>
<pre>
  IO::File;
  BaseTools::FileList
  WebTools::PhedexFiles</pre>
<p>
</p>
<hr />
<h1><a name="inheritance">INHERITANCE</a></h1>
<p>none</p>
<p>
</p>
<hr />
<h1><a name="exports">EXPORTS</a></h1>
<p>none.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p><code>dCacheTools::PhedexComparison</code> compares the local (pnfs) file list with
what PhEDEx thinks a site should have. After the analysis several files
are produced that contain the result.</p>
<p><strong>phedexonly_files.txt</strong> contains a list of files that are no longer
available locally but PhEDEx subscription is still valid, this list
of files must be invalidated in TMDB.</p>
<p><strong>pnfsonly_files.txt</strong> is a list of files which available locally and
not know to locally. This may also contains files that were long
deleted from PhEDEx but somehow managed to survive locally. One
should check the list carefully and delete the spurious entries
manually.</p>
<p>
</p>
<h2><a name="public_methods">Public methods</a></h2>
<ul>
<li><strong><a name="item_new">new ($attr): object reference</a></strong>

<p>Class constructor. The following attributes are used</p>
<pre>
  $attr-&gt;{node}            - PhEDEx node (e.g T2_IT_Pisa)
  $attr-&gt;{pnfsroot}        - The basepath of pnfs, list all the files under this path (e.g /pnfs/pi.infn.it/data/cms/store)
  $attr-&gt;{verbose}         - debug flag
  $attr-&gt;{pnfs_dump}       - complete list of files known to pnfs
  $attr-&gt;{pnfsonly_dump}   - file known only locally and not to PhEDEx
  $attr-&gt;{phedex_dump}     - complete list of files PhEDEX has record of for a site 
  $attr-&gt;{phedexonly_dump} - list of file known to PhEDEx but do not exist locally</pre>
</li>
<li><strong><a name="item_compare">compare (None): None</a></strong>

<p>Perform PhEDEx vs pnfs comparison. Save the results in 4 different files for 
further actions to be taken.</p>
</li>
<li><strong><a name="item_save">save ($class, $list, $file): None</a></strong>

<p>Save the list in a file</p>
<pre>
  $class - The package name
  $list  - an array reference that contains the list of files
  $file  - output file name</pre>
</li>
</ul>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>BaseTools::FileList, WebTools::PhedexFiles</p>
<p>
</p>
<hr />
<h1><a name="authors">AUTHORS</a></h1>
<p>Subir Sarkar (<a href="mailto:subir.sarkar@cern.ch">subir.sarkar@cern.ch</a>)</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>This software comes with absolutely no warranty whatsoever.</p>
<p>This library is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.</p>
<p>
</p>
<hr />
<h1><a name="version">VERSION</a></h1>
<p>$Id: PhedexComparison.pm,v 1.0 2008/06/17 00:03:19 sarkar Exp $</p>

</body>

</html>
